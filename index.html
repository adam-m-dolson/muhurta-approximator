<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Muhurta Time Approximator</title>

  <!-- Bootstrap CSS (CDN) -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />

  <style>
    body { background: #f8f9fa; }
    .card { border: 0; box-shadow: 0 6px 20px rgba(0,0,0,0.06); }
    .mono { font-variant-numeric: tabular-nums; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
  </style>
</head>
<body>
  <div class="container py-5">
    <div class="row justify-content-center">
      <div class="col-lg-8">
        <div class="card">
          <div class="card-body p-4 p-md-5">
            <h1 class="h3 mb-2">Muhurta Time Approximator</h1>
            <p class="text-muted mb-4">
              Select the sunrise time (24-hour clock). The table updates with the approximated Muhurta times.
            </p>

            <form id="timeForm" class="row g-3 align-items-end">
              <div class="col-sm-6">
                <label for="hourSelect" class="form-label">Sunrise Hour</label>
                <select id="hourSelect" class="form-select" aria-label="Select sunrise hour"></select>
              </div>

              <div class="col-sm-6">
                <label for="minuteSelect" class="form-label">Sunrise Minute</label>
                <select id="minuteSelect" class="form-select" aria-label="Select sunrise minute"></select>
              </div>

              <div class="col-12 d-flex gap-2 mt-2">
                <button type="button" id="calcBtn" class="btn btn-primary">
                  Approximate
                </button>
                <button type="button" id="resetBtn" class="btn btn-outline-secondary">
                  Reset
                </button>
              </div>
            </form>

            <hr class="my-4" />

            <div class="table-responsive">
              <table class="table table-striped align-middle mb-0">
                <thead>
                  <tr>
                    <th scope="col">Muhurta</th>
                    <th scope="col">Offset from Sunrise</th>
                    <th scope="col">Time</th>
                  </tr>
                </thead>
                <tbody id="resultsBody">
                  <tr>
                    <td colspan="3" class="text-muted">Choose a sunrise time and click Approximate.</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <div class="text-center text-muted small mt-3">
          Built with HTML, CSS, JavaScript, and Bootstrap.
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS (optional, for some components; not strictly needed here) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // --- Helpers ---
    const pad2 = (n) => String(n).padStart(2, "0");

    // Convert hour/minute to minutes since midnight (0..1439)
    function toMinutesSinceMidnight(h, m) {
      return (h * 60) + m;
    }

    // Convert minutes since midnight (0..1439) to "HH:MM" (24h)
    function formatHHMM24(totalMinutes) {
      const h = Math.floor(totalMinutes / 60);
      const m = totalMinutes % 60;
      return `${pad2(h)}:${pad2(m)}`;
    }

    // Convert minutes since midnight (0..1439) to "h:MM AM/PM" (12h)
    function formatHHMM12(totalMinutes) {
      const h24 = Math.floor(totalMinutes / 60);
      const m = totalMinutes % 60;
      const ampm = h24 >= 12 ? "PM" : "AM";
      let h12 = h24 % 12;
      if (h12 === 0) h12 = 12;
      return `${h12}:${pad2(m)} ${ampm}`;
    }

    // For a sunrise minutes value, apply delta minutes and return formatted time + day offset
    function applyDelta(sunriseMin, deltaMin) {
      const raw = sunriseMin + deltaMin;

      // dayOffset: -1 for previous day, 0 for same day, +1 for next day, etc.
      const dayOffset = Math.floor(raw / 1440); // Math.floor works correctly for negative values

      // modulo to keep within 0..1439
      const mod = ((raw % 1440) + 1440) % 1440;

      return { timeMin: mod, dayOffset };
    }

    function dayOffsetBadge(dayOffset) {
      if (dayOffset === 0) return "";
      const label = dayOffset === -1 ? "Prev day"
                  : dayOffset === 1  ? "Next day"
                  : (dayOffset < 0) ? `${dayOffset} days`
                  : `+${dayOffset} days`;

      const cls = dayOffset < 0 ? "text-bg-secondary" : "text-bg-info";
      return ` <span class="badge ${cls} ms-2">${label}</span>`;
    }

    // --- Data ---
    // 4h48m = 288, 9h36m = 576, 14h24m = 864
    const rows = [
      { name: "Aditi Muhurta",      delta: -288, label: "âˆ’ 4h 48m" },
      { name: "Rudra Muhurta",      delta:    0, label: "Sunrise" },
      { name: "Visvedeva Muhurta", delta:  288, label: "+ 4h 48m" },
      { name: "Varuna Muhurta",     delta:  576, label: "+ 9h 36m" },
      { name: "Pushya Muhurta",     delta:  864, label: "+ 14h 24m" },
    ];

    // --- UI Setup ---
    const hourSelect = document.getElementById("hourSelect");
    const minuteSelect = document.getElementById("minuteSelect");
    const resultsBody = document.getElementById("resultsBody");
    const calcBtn = document.getElementById("calcBtn");
    const resetBtn = document.getElementById("resetBtn");

    function populateDropdowns() {
      // Hours 00..23
      hourSelect.innerHTML = "";
      for (let h = 0; h <= 23; h++) {
        const opt = document.createElement("option");
        opt.value = String(h);
        opt.textContent = pad2(h);
        hourSelect.appendChild(opt);
      }

      // Minutes 00..59
      minuteSelect.innerHTML = "";
      for (let m = 0; m <= 59; m++) {
        const opt = document.createElement("option");
        opt.value = String(m);
        opt.textContent = pad2(m);
        minuteSelect.appendChild(opt);
      }
    }

    function setDefaultTime() {
      hourSelect.value = "6";
      minuteSelect.value = "0";
    }

    function renderTable(sunriseMin) {
      const html = rows.map(r => {
        const res = applyDelta(sunriseMin, r.delta);
        const t24 = formatHHMM24(res.timeMin);
        const t12 = formatHHMM12(res.timeMin);
        const badge = dayOffsetBadge(res.dayOffset);

        return `
          <tr>
            <td>${r.name}</td>
            <td class="mono">${r.label}</td>
            <td class="mono">
              ${t24} <span class="text-muted">(${t12})</span>${badge}
              ${r.delta === 0 ? ` <span class="badge text-bg-success ms-2">Selected</span>` : ""}
            </td>
          </tr>
        `;
      }).join("");

      resultsBody.innerHTML = html;
    }

    function approximate() {
      const h = parseInt(hourSelect.value, 10);
      const m = parseInt(minuteSelect.value, 10);
      const sunriseMin = toMinutesSinceMidnight(h, m);
      renderTable(sunriseMin);
    }

    function reset() {
      setDefaultTime();
      resultsBody.innerHTML = `
        <tr>
          <td colspan="3" class="text-muted">Choose a sunrise time and click Approximate.</td>
        </tr>
      `;
    }

    // --- Events ---
    calcBtn.addEventListener("click", approximate);
    resetBtn.addEventListener("click", reset);

    // Also recalc on change (nice UX)
    hourSelect.addEventListener("change", approximate);
    minuteSelect.addEventListener("change", approximate);

    // Init
    populateDropdowns();
    setDefaultTime();
    approximate();
  </script>
</body>
</html>